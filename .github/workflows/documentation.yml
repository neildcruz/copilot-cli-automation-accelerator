# Example Workflow: AI Documentation Generation with Copilot CLI
# 
# This workflow generates or improves documentation
# using the Copilot CLI Automation Action.
#
# Copy this file to .github/workflows/ in your repository to use it.

name: AI Documentation Generation

on:
  push:
    branches: [main]
    paths:
      - 'src/**'
      - 'lib/**'
      - '*.ts'
      - '*.js'
      - '*.py'
  
  workflow_dispatch:
    inputs:
      doc_type:
        description: 'Type of documentation to generate'
        required: true
        type: choice
        options:
          - readme
          - api
          - getting-started
          - all
        default: 'all'
      output_format:
        description: 'Output format'
        required: true
        type: choice
        options:
          - markdown
          - html
        default: 'markdown'

jobs:
  documentation:
    name: AI Documentation Generation
    uses: ./.github/workflows/copilot-cli-action.yml
    with:
      agent: documentation-generation
      user_prompt: |
        Analyze this codebase and generate or improve documentation.
        
        Please:
        1. Review existing documentation for completeness and accuracy
        2. Identify undocumented features, functions, or APIs
        3. Suggest improvements to README files
        4. Generate API documentation for public interfaces
        5. Create usage examples where missing
        6. Add installation and setup instructions if needed
        7. Include troubleshooting tips for common issues
        
        Output documentation in Markdown format with:
        - Clear headings and structure
        - Code blocks with language hints
        - Tables where appropriate
        - Links to related documentation
      copilot_cli_properties: |
        # Documentation Generation Configuration
        copilot.model=claude-sonnet-4.5
        auto.install.cli=true
        allow.all.tools=true
        allow.all.paths=false
        working.directory=.
        log.level=info
        timeout.minutes=30
    secrets: inherit

  display-results:
    name: Display Documentation Results
    needs: documentation
    if: always() && needs.documentation.result == 'success'
    runs-on: ubuntu-latest
    steps:
      - name: Display Documentation Results
        run: |
          echo "## ðŸ“š Documentation Generation Results" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "${{ needs.documentation.outputs.copilot_output }}" >> $GITHUB_STEP_SUMMARY
      
      - name: Suggest Next Steps
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "---" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ“ Next Steps" >> $GITHUB_STEP_SUMMARY
          echo "1. Review the generated documentation above" >> $GITHUB_STEP_SUMMARY
          echo "2. Copy relevant sections to your project files" >> $GITHUB_STEP_SUMMARY
          echo "3. Commit and push the updated documentation" >> $GITHUB_STEP_SUMMARY
